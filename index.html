<!DOCTYPE html>
<html>
  <head>
    <title>Global Chat Imonskart</title>
    <style>
      body { font-family: sans-serif; padding: 20px; }
      #chat-box { border: 1px solid #ccc; height: 300px; overflow-y: scroll; padding: 10px; }
      #chat-box div { margin-bottom: 5px; }
    </style>
  </head>
  <body>
    <h2>Global Chat</h2>
    <div id="chat-box"></div>
    <input type="text" id="username" placeholder="Your name" />
    <input type="text" id="message" placeholder="Type message..." />
    <button onclick="sendMessage()">Send</button>

    <script type="module">
      import { initializeApp } from "https://www.gstatic.com/firebasejs/11.7.1/firebase-app.js";
      import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/11.7.1/firebase-database.js";

      const firebaseConfig = {
        apiKey: "AIzaSyClV-VFgaSfz6l3iOSopwtfK1LwAlL4i2w",
        authDomain: "imonskart2.firebaseapp.com",
        databaseURL: "https://imonskart2-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "imonskart2",
        storageBucket: "imonskart2.appspot.com",
        messagingSenderId: "227777650202",
        appId: "1:227777650202:web:92e8e12d0ac4e5017a7ba3"
      };

      const app = initializeApp(firebaseConfig);
      const db = getDatabase(app);

      const chatRef = ref(db, "globalChat");

      // Tampilkan pesan real-time
      onChildAdded(chatRef, (data) => {
        const chatBox = document.getElementById("chat-box");
        const val = data.val();
        const el = document.createElement("div");
        el.textContent = `${val.name}: ${val.message}`;
        chatBox.appendChild(el);
        chatBox.scrollTop = chatBox.scrollHeight;
      });

      // Kirim pesan
      window.sendMessage = () => {
        const name = document.getElementById("username").value || "Anon";
        const message = document.getElementById("message").value;
        if (message.trim() !== "") {
          push(chatRef, {
            name: name,
            message: message
          });
          document.getElementById("message").value = "";
        }
      };
    </script>
  </body>
</html
